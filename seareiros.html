<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema de Registro de Vendas</title>
<style>
/* --- ESTILO PADR√ÉO (DESKTOP E GRANDE) --- */
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height:100vh; padding:20px;}
.container { max-width:1200px; margin:0 auto; background:white; border-radius:15px; box-shadow:0 15px 35px rgba(0,0,0,0.1); overflow:hidden;}
.header { background:linear-gradient(135deg,#2c3e50,#3498db); color:white; padding:30px; text-align:center;}
.header h1 { font-size:2.5rem; margin-bottom:10px;}
.header p { opacity:0.9; font-size:1.1rem;}
.tabs { display:flex; background:#f8f9fa; border-bottom:1px solid #dee2e6;}
.tab { flex:1; padding:20px; background:none; border:none; cursor:pointer; font-size:1.1rem; font-weight:600; color:#666; transition:all 0.3s ease; border-bottom:3px solid transparent;}
.tab.active { color:#3498db; border-bottom-color:#3498db; background:white;}
.tab:hover { background:#e9ecef; }
.content { padding:30px; min-height:500px;}
.tab-content { display:none; animation:fadeIn 0.3s ease-in-out;}
.tab-content.active { display:block;}
@keyframes fadeIn { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);}}
.form-section { background:#f8f9fa; padding:25px; border-radius:10px; margin-bottom:30px; border-left:4px solid #3498db;}
.form-section h3 { color:#2c3e50; margin-bottom:20px; font-size:1.3rem;}
.form-group { margin-bottom:20px;}
.form-row { display:flex; gap:15px; align-items:end;}
.form-row .form-group { flex:1;}
label { display:block; margin-bottom:8px; font-weight:600; color:#2c3e50;}
input, select, textarea { width:100%; padding:12px; border:2px solid #e0e6ed; border-radius:8px; font-size:1rem; transition:all 0.3s ease;}
input:focus, select:focus, textarea:focus { outline:none; border-color:#3498db; box-shadow:0 0 0 3px rgba(52,152,219,0.1);}
.btn { padding:12px 24px; border:none; border-radius:8px; font-size:1rem; font-weight:600; cursor:pointer; transition:all 0.3s ease; text-transform:uppercase; letter-spacing:0.5px;}
.btn-primary { background:linear-gradient(135deg,#3498db,#2980b9); color:white;}
.btn-primary:hover { background:linear-gradient(135deg,#2980b9,#1f618d); transform:translateY(-2px); box-shadow:0 5px 15px rgba(52,152,219,0.3);}
.btn-success { background:linear-gradient(135deg,#27ae60,#229954); color:white;}
.btn-success:hover { background:linear-gradient(135deg,#229954,#1e8449); transform:translateY(-2px); box-shadow:0 5px 15px rgba(39,174,96,0.3);}
.btn-danger { background:linear-gradient(135deg,#e74c3c,#c0392b); color:white;}
.btn-danger:hover { background:linear-gradient(135deg,#c0392b,#a93226); transform:translateY(-2px); box-shadow:0 5px 15px rgba(231,76,60,0.3);}
.btn-warning { background:linear-gradient(135deg,#f39c12,#e67e22); color:white;}
.btn-warning:hover { background:linear-gradient(135deg,#e67e22,#d35400); transform:translateY(-2px); box-shadow:0 5px 15px rgba(243,156,18,0.3);}
.btn-secondary { background:linear-gradient(135deg,#95a5a6,#7f8c8d); color:white;}
.btn-secondary:hover { background:linear-gradient(135deg,#7f8c8d,#6c7b7d); transform:translateY(-2px);}
.item-list, .sales-list { background:white; border-radius:10px; padding:20px; box-shadow:0 2px 10px rgba(0,0,0,0.1);}
.item-card, .sale-card { background:#f8f9fa; border:1px solid #e9ecef; border-radius:8px; padding:15px; margin-bottom:15px; transition:all 0.3s ease;}
.item-card:hover, .sale-card:hover { transform:translateY(-2px); box-shadow:0 5px 15px rgba(0,0,0,0.1);}
.item-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;}
.item-name { font-weight:600; font-size:1.1rem; color:#2c3e50;}
.item-price { color:#27ae60; font-weight:600; font-size:1.1rem;}
.item-stock { color:#666; font-size:0.9rem;}
.item-actions { display:flex; gap:10px; margin-top:15px;}
.sale-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;}
.client-name { font-weight:600; font-size:1.2rem; color:#2c3e50;}
.sale-date { color:#666; font-size:0.9rem;}
.sale-items { background:white; border-radius:5px; padding:15px; margin-bottom:15px;}
.sale-item { display:flex; justify-content:space-between; align-items:center; padding:8px 0; border-bottom:1px solid #f0f0f0;}
.sale-item:last-child { border-bottom:none;}
.sale-total { font-weight:600; font-size:1.2rem; color:#27ae60; text-align:right; margin-bottom:15px;}
.status-badge { padding:5px 12px; border-radius:20px; font-size:0.8rem; font-weight:600; text-transform:uppercase;}
.status-pending { background:#fff3cd; color:#856404;}
.status-delivered { background:#d4edda; color:#155724;}
.sale-actions { display:flex; gap:10px; justify-content:flex-end;}
.reset-section { text-align:center; padding:30px; background:#fff5f5; border-radius:10px; border:2px dashed #e74c3c;}
.reset-section h3 { color:#e74c3c; margin-bottom:15px;}
.reset-section p { color:#666; margin-bottom:20px;}
.empty-state { text-align:center; padding:60px 20px; color:#666;}
.empty-state i { font-size:4rem; margin-bottom:20px; opacity:0.5;}
.stats { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:20px; margin-bottom:30px;}
.stat-card { background:white; padding:20px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.1); text-align:center; border-top:4px solid #3498db;}
.stat-number { font-size:2rem; font-weight:600; color:#2c3e50; margin-bottom:5px;}
.stat-label { color:#666; font-size:0.9rem; text-transform:uppercase; letter-spacing:0.5px;}
.low-stock { border-left:4px solid #e74c3c; padding-left:10px;}

/* --- MEDIA QUERIES (ESTILOS PARA TELAS MENORES) --- */
@media (max-width: 768px) {
    body { padding: 10px; }
    .container { border-radius: 0; }
    .header h1 { font-size: 1.8rem; }
    .header p { font-size: 1rem; }
    .tabs { flex-wrap: wrap; }
    .tab { font-size: 0.9rem; padding: 15px; }
    .content { padding: 15px; }
    .form-row { flex-direction: column; align-items: stretch; gap: 0; }
    .form-row .form-group { margin-bottom: 15px; }
    .btn { width: 100%; padding: 15px; }
    .btn.btn-secondary { margin-top: 10px; }
    .item-header, .sale-header { flex-direction: column; align-items: flex-start; }
    .item-price, .sale-date { margin-top: 5px; }
    .item-actions, .sale-actions { flex-direction: column; gap: 10px; width: 100%; }
    .sale-actions .btn { width: 100%; }
    .sale-item { flex-direction: column; align-items: flex-start; }
    .sale-item span:last-child { margin-top: 5px; }
    .stats { grid-template-columns: 1fr; }
    .reset-section .btn { width: 100%; }
}
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>üõí Sistema de Vendas</h1>
        <p>Gerencie produtos, vendas e estoque de forma eficiente</p>
    </div>

    <div class="tabs">
        <button class="tab" onclick="showTab('register')">‚ûï Pedidos</button>
        <button class="tab" onclick="showTab('sales')">üí∞ Vendas/Retiradas</button>
        <button class="tab active" onclick="showTab('products')">üì¶ Produtos/Estoque</button>
        <button class="tab" onclick="showTab('settings')">‚öôÔ∏è Configura√ß√µes</button>
    </div>

    <div class="content">
        <div id="products" class="tab-content active">
            <div class="form-section">
                <h3>Adicionar Novo Produto</h3>
                <div class="form-row">
                    <div class="form-group"><label for="productName">Nome do Produto</label><input type="text" id="productName" placeholder="Ex: Bolo de Chocolate"></div>
                    <div class="form-group"><label for="productPrice">Pre√ßo (R$)</label><input type="number" id="productPrice" step="0.01" placeholder="25.00"></div>
                    <div class="form-group"><label for="productStock">Estoque</label><input type="number" id="productStock" placeholder="10"></div>
                    <div class="form-group"><button class="btn btn-primary" onclick="addProduct()">Adicionar</button></div>
                </div>
            </div>
            <div class="item-list" id="productsList"></div>
        </div>

        <div id="sales" class="tab-content">
            <div style="margin-bottom:10px;">
                <button class="btn btn-warning" onclick="generatePDF()">üìÑ Gerar Relat√≥rio PDF</button>
            </div>
            <div class="stats" id="salesStats"></div>
            <div class="sales-list" id="salesList"></div>
        </div>

        <div id="register" class="tab-content">
            <div class="form-section">
                <h3>Registrar Nova Venda</h3>
                <div class="form-group">
                    <label for="clientName">Nome do Cliente</label>
                    <input type="text" id="clientName" placeholder="Nome completo do cliente">
                </div>
            </div>
            <div class="form-section">
                <h3>Itens da Venda</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="saleProduct">Produto</label>
                        <select id="saleProduct"><option value="">Selecione um produto</option></select>
                    </div>
                    <div class="form-group">
                        <label for="saleQuantity">Quantidade</label>
                        <input type="number" id="saleQuantity" min="1" placeholder="1">
                    </div>
                    <div class="form-group"><button class="btn btn-success" onclick="addSaleItem()">Adicionar Item</button></div>
                </div>
                <div id="saleItems" class="item-list" style="margin-top:20px;"></div>
                <div style="text-align:right; margin-top:20px;">
                    <div class="sale-total" id="saleTotal">Total: R$ 0,00</div>
                    <button class="btn btn-primary" onclick="completeSale()" style="margin-right:10px;">Finalizar Venda</button>
                    <button class="btn btn-secondary" onclick="clearSale()">Limpar</button>
                </div>
            </div>
        </div>

        <div id="settings" class="tab-content">
            <div class="reset-section">
                <h3>‚ö†Ô∏è Zona de Perigo</h3>
                <p>Esta a√ß√£o apagar√° todos os dados salvos (produtos, vendas, etc.). Esta a√ß√£o n√£o pode ser desfeita!</p>
                <button class="btn btn-danger" onclick="resetAllData()">üóëÔ∏è Resetar Todos os Dados</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
// --- Estado da aplica√ß√£o ---
let products = JSON.parse(localStorage.getItem('products')) || [];
let sales = JSON.parse(localStorage.getItem('sales')) || [];
let currentSaleItems = [];

// --- Fun√ß√µes b√°sicas ---
function saveData(){ localStorage.setItem('products',JSON.stringify(products)); localStorage.setItem('sales',JSON.stringify(sales)); }

function showTab(tabName){
    document.querySelectorAll('.tab-content').forEach(tab=>tab.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(tab=>tab.classList.remove('active'));
    document.getElementById(tabName).classList.add('active');
    event.target.classList.add('active');
    if(tabName==='products') loadProducts();
    else if(tabName==='sales'){ loadSales(); loadSalesStats();}
    else if(tabName==='register'){ loadProductOptions();}
}

// --- Produtos ---
function addProduct(){
    const name=document.getElementById('productName').value.trim();
    const price=parseFloat(document.getElementById('productPrice').value);
    const stock=parseInt(document.getElementById('productStock').value);
    if(!name || isNaN(price)||isNaN(stock)||price<=0||stock<0){alert('Preencha todos os campos corretamente!'); return;}
    const product={id:Date.now(),name,price,stock,createdAt:new Date().toISOString()};
    products.push(product); saveData();
    document.getElementById('productName').value=''; document.getElementById('productPrice').value=''; document.getElementById('productStock').value='';
    loadProducts(); alert('Produto adicionado!');
}

function loadProducts(){
    const container=document.getElementById('productsList');
    if(products.length===0){ container.innerHTML='<div class="empty-state"><div style="font-size:4rem;margin-bottom:20px;">üì¶</div><h3>Nenhum produto cadastrado</h3><p>Adicione seu primeiro produto.</p></div>'; return; }
    container.innerHTML=products.map(p=>`<div class="item-card ${p.stock<=3?'low-stock':''}"><div class="item-header"><span class="item-name">${p.name}</span><span class="item-price">R$ ${p.price.toFixed(2)}</span></div><div class="item-stock">Estoque: ${p.stock} unidades</div><div class="item-actions"><button class="btn btn-warning" onclick="editProduct(${p.id})">‚úèÔ∏è Editar</button><button class="btn btn-danger" onclick="deleteProduct(${p.id})">üóëÔ∏è Excluir</button></div></div>`).join('');
}

function editProduct(id){ const p=products.find(x=>x.id===id); if(!p) return; const n=prompt('Nome:',p.name); if(n===null)return; const pr=prompt('Pre√ßo:',p.price); if(pr===null)return; const st=prompt('Estoque:',p.stock); if(st===null)return; const price=parseFloat(pr); const stock=parseInt(st); if(!n.trim()||isNaN(price)||isNaN(stock)||price<=0||stock<0){alert('Dados inv√°lidos!'); return;} p.name=n.trim(); p.price=price; p.stock=stock; saveData(); loadProducts(); alert('Produto atualizado!');}

function deleteProduct(id){ if(!confirm('Excluir este produto?')) return; products=products.filter(p=>p.id!==id); saveData(); loadProducts(); alert('Produto exclu√≠do!');}

function loadProductOptions(){
    const sel=document.getElementById('saleProduct'); sel.innerHTML='<option value="">Selecione um produto</option>';
    products.filter(p=>p.stock>0).forEach(p=>{ sel.innerHTML+=`<option value="${p.id}">${p.name} - R$ ${p.price.toFixed(2)} (Estoque: ${p.stock})</option>`; });
}

// --- Venda ---
function addSaleItem(){
    const productId=parseInt(document.getElementById('saleProduct').value);
    const quantity=parseInt(document.getElementById('saleQuantity').value);
    if(!productId||!quantity||quantity<=0){alert('Selecione produto e quantidade v√°lida!'); return;}
    const p=products.find(x=>x.id===productId); if(!p){alert('Produto n√£o encontrado!'); return;}
    if(quantity>p.stock){alert(`Estoque insuficiente! Dispon√≠vel: ${p.stock}`); return;}
    const exist=currentSaleItems.find(i=>i.productId===productId);
    if(exist){ if(exist.quantity+quantity>p.stock){ alert(`Estoque insuficiente! J√° tem ${exist.quantity} deste produto.`); return;} exist.quantity+=quantity; } 
    else{ currentSaleItems.push({productId,name:p.name,price:p.price,quantity});}
    document.getElementById('saleProduct').value=''; document.getElementById('saleQuantity').value=''; updateSaleDisplay();
}

function updateSaleDisplay(){
    const c=document.getElementById('saleItems'); const t=document.getElementById('saleTotal'); 
    if(currentSaleItems.length===0){ c.innerHTML='<div class="empty-state"><p>Nenhum item adicionado.</p></div>'; t.textContent='Total: R$ 0,00'; return;}
    let total=0;
    c.innerHTML=currentSaleItems.map((i,idx)=>{ const st=i.price*i.quantity; total+=st; return `<div class="sale-item"><span>${i.name} x${i.quantity}</span><span>R$ ${st.toFixed(2)} <button class="btn btn-danger" style="padding:5px 10px; margin-left:10px;" onclick="removeSaleItem(${idx})">‚ùå</button></span></div>`;}).join('');
    t.textContent=`Total: R$ ${total.toFixed(2)}`;
}

function removeSaleItem(idx){ currentSaleItems.splice(idx,1); updateSaleDisplay(); }

function completeSale(){
    const clientName=document.getElementById('clientName').value.trim();
    if(!clientName){alert('Informe o nome do cliente!'); return;}
    if(currentSaleItems.length===0){alert('Adicione pelo menos um item!'); return;}
    currentSaleItems.forEach(i=>{ const p=products.find(x=>x.id===i.productId); if(p) p.stock-=i.quantity;});
    const sale={id:Date.now(),clientName,items:[...currentSaleItems],total:currentSaleItems.reduce((s,i)=>s+(i.price*i.quantity),0),delivered:false,createdAt:new Date().toISOString()};
    sales.push(sale); saveData(); clearSale(); alert('Venda registrada!');
}

function clearSale(){ currentSaleItems=[]; document.getElementById('clientName').value=''; document.getElementById('saleProduct').value=''; document.getElementById('saleQuantity').value=''; updateSaleDisplay(); }

// --- Carregar vendas ---
function loadSales(){
    const container=document.getElementById('salesList');
    if(sales.length===0){ container.innerHTML='<div class="empty-state"><div style="font-size:4rem;margin-bottom:20px;">üí∞</div><h3>Nenhuma venda registrada</h3><p>As vendas realizadas aparecer√£o aqui.</p></div>'; return;}
    const sorted=[...sales].sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt));
    container.innerHTML=sorted.map(s=>`<div class="sale-card ${s.delivered?'delivered':'pending'}"><div class="sale-header"><span class="client-name">${s.clientName}</span><span class="sale-date">${new Date(s.createdAt).toLocaleDateString('pt-BR')} √†s ${new Date(s.createdAt).toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'})}</span></div><div class="sale-items">${s.items.map(i=>`<div class="sale-item"><span>${i.name} x${i.quantity}</span><span>R$ ${(i.price*i.quantity).toFixed(2)}</span></div>`).join('')}</div><div class="sale-total">Total: R$ ${s.total.toFixed(2)}</div><div style="display:flex;justify-content:space-between;align-items:center;"><span class="status-badge ${s.delivered?'status-delivered':'status-pending'}">${s.delivered?'‚úÖ Entregue':'‚è≥ Pendente'}</span><div class="sale-actions">${!s.delivered?`<button class="btn btn-success" onclick="markAsDelivered(${s.id})">‚úÖ Marcar como Entregue</button>`:''}<button class="btn btn-danger" onclick="deleteSale(${s.id})">üóëÔ∏è Excluir</button></div></div></div>`).join('');
}

// --- Marcar entrega e excluir ---
function markAsDelivered(id){ const s=sales.find(x=>x.id===id); if(s){s.delivered=true; saveData(); loadSales(); loadSalesStats(); alert('Pedido entregue!');}}
function deleteSale(id){ if(!confirm('Excluir venda?')) return; sales=sales.filter(x=>x.id!==id); saveData(); loadSales(); loadSalesStats(); alert('Venda exclu√≠da!');}

// --- Estat√≠sticas ---
function loadSalesStats(){
    const c=document.getElementById('salesStats');
    const total=sales.length, pending=sales.filter(s=>!s.delivered).length, delivered=sales.filter(s=>s.delivered).length, revenue=sales.reduce((sum,s)=>sum+s.total,0);
    c.innerHTML=`<div class="stat-card"><div class="stat-number">${total}</div><div class="stat-label">Total de Vendas</div></div><div class="stat-card"><div class="stat-number">${pending}</div><div class="stat-label">Pendentes</div></div><div class="stat-card"><div class="stat-number">${delivered}</div><div class="stat-label">Entregues</div></div><div class="stat-card"><div class="stat-number">R$ ${revenue.toFixed(2)}</div><div class="stat-label">Receita Total</div></div>`;
}

// --- Resetar dados ---
function resetAllData(){ const c=prompt('Digite "CONFIRMAR" para reset:'); if(c!=='CONFIRMAR'){alert('Cancelado'); return;} localStorage.removeItem('products'); localStorage.removeItem('sales'); products=[]; sales=[]; currentSaleItems=[]; document.getElementById('productName').value=''; document.getElementById('productPrice').value=''; document.getElementById('productStock').value=''; document.getElementById('clientName').value=''; document.getElementById('saleProduct').value=''; document.getElementById('saleQuantity').value=''; loadProducts(); loadSales(); loadSalesStats(); updateSaleDisplay(); alert('Dados resetados!');}

// --- Gerar PDF ---
function generatePDF(){
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    doc.setFontSize(18); doc.text("Relat√≥rio de Vendas", 14, 22);
    let y=32;
    sales.forEach(s=>{
        doc.setFontSize(12);
        doc.text(`Cliente: ${s.clientName} | Total: R$ ${s.total.toFixed(2)} | ${s.delivered?'Entregue':'Pendente'} | ${new Date(s.createdAt).toLocaleString('pt-BR')}`,14,y);
        y+=6;
        s.items.forEach(i=>{
            doc.text(` - ${i.name} x${i.quantity} = R$ ${(i.price*i.quantity).toFixed(2)}`,16,y);
            y+=6;
        });
        y+=4;
        if(y>270){ doc.addPage(); y=20;}
    });
    doc.save(`RelatorioVendas_${new Date().toISOString().split('T')[0]}.pdf`);
}

// --- Inicializa√ß√£o ---
document.addEventListener('DOMContentLoaded',function(){ loadProducts(); loadSales(); loadSalesStats(); loadProductOptions(); updateSaleDisplay(); });
</script>
</body>
</html>
